

function [m_index] = MVT_olivine_m_index(filename)

     x = [0.5	1.5	2.5	3.5	4.5	5.5	6.5	7.5	8.5	9.5	10.5	11.5	12.5	13.5	14.5	15.5	16.5	17.5	18.5	19.5	20.5	21.5	22.5	23.5	24.5	25.5	26.5	27.5	28.5	29.5	30.5	31.5	32.5	33.5	34.5	35.5	36.5	37.5	38.5	39.5	40.5	41.5	42.5	43.5	44.5	45.5	46.5	47.5	48.5	49.5	50.5	51.5	52.5	53.5	54.5	55.5	56.5	57.5	58.5	59.5	60.5	61.5	62.5	63.5	64.5	65.5	66.5	67.5	68.5	69.5	70.5	71.5	72.5	73.5	74.5	75.5	76.5	77.5	78.5	79.5	80.5	81.5	82.5	83.5	84.5	85.5	86.5	87.5	88.5	89.5	90.5	91.5	92.5	93.5	94.5	95.5	96.5	97.5	98.5	99.5	100.5	101.5	102.5	103.5	104.5	105.5	106.5	107.5	108.5	109.5	110.5	111.5	112.5	113.5	114.5	115.5	116.5	117.5	118.5	119.5];
     t_theory = [0.0000008462	0.0000076150	0.0000211506	0.0000414489	0.0000685037	0.0001023070	0.0001428480	0.0001901140	0.0002440920	0.0003047640	0.0003721130	0.0004461180	0.0005267550	0.0006140020	0.0007078300	0.0008082120	0.0009151170	0.0010285100	0.0011483600	0.0012746300	0.0014072800	0.0015462800	0.0016915700	0.0018431100	0.0020008600	0.0021647700	0.0023347900	0.0025108700	0.0026929500	0.0028809800	0.0030749100	0.0032746600	0.0034801900	0.0036914300	0.0039083100	0.0041307700	0.0043587400	0.0045921500	0.0048309300	0.0050750100	0.0053243100	0.0055787600	0.0058382800	0.0061027900	0.0063722100	0.0066464600	0.0069254500	0.0072091100	0.0074973300	0.0077900400	0.0080871500	0.0083885600	0.0086941900	0.0090039400	0.0093177100	0.0096354200	0.0099569600	0.0102822000	0.0106111000	0.0109436000	0.0112795000	0.0116187000	0.0119611000	0.0123067000	0.0126553000	0.0130068000	0.0133611000	0.0137181000	0.0140778000	0.0144398000	0.0148043000	0.0151710000	0.0155399000	0.0159108000	0.0162836000	0.0166582000	0.0170345000	0.0174125000	0.0177918000	0.0181725000	0.0185545000	0.0189376000	0.0193216000	0.0197066000	0.0200923000	0.0204787000	0.0208656000	0.0212529000	0.0216405000	0.0220283000	0.0218318000	0.0210360000	0.0202201000	0.0193846000	0.0185296000	0.0176555000	0.0167624000	0.0158507000	0.0149206000	0.0139725000	0.0130065000	0.0120231000	0.0110224000	0.0100049000	0.0089707300	0.0079203200	0.0068539700	0.0057719800	0.0046747000	0.0035637700	0.0027150900	0.0020660600	0.0015427600	0.0011176900	0.0007749770	0.0005039540	0.0002968710	0.0001477920	0.0000520028	0.0000056557];
 
     CS = symmetry('Pbnm', [4.75, 10.20, 5.98]);
     SS = symmetry('-1');
    
     % Get Euler angles
     [eulers, n] = MVT_read_VPSC_file(filename);
     
     % Turn into an array MTEX oritnetation objects
     orientations = orientation(rotation('Euler',eulers(1,:)*degree,...
         eulers(2,:)*degree,eulers(3,:)*degree),CS,SS);
     
     k = 1;
     angles = zeros(1, (n*n)/2);
     for i=1:n 
         for j=i:n
             % Get angle bit of angle-axis missorentation in degrees
             angles(k) = angle(orientations(j),orientations(i)) / degree;
             k = k + 1;
         end
     end
     
     t_data = histc(angles,x);
     t_data = t_data / ((n*n)/2);
     
     m_indexs = (abs(t_data-t_theory));
     m_index = sum(m_indexs)*(120.0/length(x));
     
     plot(x, t_data, x, t_theory)
     legend('data','theoretical random distribution');
     xlabel('Uncorrelated misorientation angle (degrees)');
     ylabel('Frequency');
     
     fprintf('M-index is: %5g', m_index);
 
end